<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shamayla Durrin Islam">
<meta name="dcterms.date" content="2024-09-22">

<title>Hate Crimes in Toronto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="finalpaper_files/libs/clipboard/clipboard.min.js"></script>
<script src="finalpaper_files/libs/quarto-html/quarto.js"></script>
<script src="finalpaper_files/libs/quarto-html/popper.min.js"></script>
<script src="finalpaper_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="finalpaper_files/libs/quarto-html/anchor.min.js"></script>
<link href="finalpaper_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="finalpaper_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="finalpaper_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="finalpaper_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="finalpaper_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hate Crimes in Toronto</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shamayla Durrin Islam </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 22, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">1 Introduction</h2>
</section>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">2 Data</h2>
</section>
<section id="raw-data" class="level2">
<h2 class="anchored" data-anchor-id="raw-data">2.1 Raw Data</h2>
<p>The dataset used in this analysis includes all verified hate crime occurrences investigated by the Hate Crime Unit by reported date since 2018. The Hate Crime categories (bias categories) include Age, Mental or Physical Disability, Race, Ethnicity, Language, Religion, Sexual Orientation, Gender, and Other Similar Factors. The dataset is provided at the offence and/or occurrence level, meaning that one occurrence may have multiple bias categories associated with it. The data does not include occurrences deemed unfounded or classified as hate incidents.</p>
<p>The hate crimes in the dataset are categorized according to a clear legal definition:</p>
<p><strong>Hate Crime:</strong> A criminal offence committed against a person or property motivated in whole or in part by bias, prejudice, or hate based on race, national or ethnic origin, language, color, religion, sex, age, mental or physical disability, sexual orientation, or gender identity.</p>
<p><strong>Hate Incident:</strong> A non-criminal action motivated by hate against an identifiable group, such as using racial slurs.</p>
<p>This data was obtained from Open Data Toronto through the <strong>opendatatoronto</strong> library (Gelfand 2022) [@gelfand2022] All analysis was conducted in R (R Core Team 2023) [@r2023] using packages such as <strong>dplyr</strong> (Wickham 2023) and <strong>ggplot2</strong> (Wickham 2016)[@wickham2016]. The raw data features occurrences since 2018, providing valuable insight into hate crime trends in Toronto.</p>
<p>We also utilized the Toronto neighborhoods shapefile, which was obtained from Open Data Toronto to map and visualize the geographic distribution of hate crimes across the city. This allowed for a spatial analysis of hate crimes by neighborhood [@opendatatoronto2022].</p>
</section>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">2.2 Data Cleaning</h2>
<p>Upon inspecting the dataset, it became clear that most of the data was already in good condition, as many variables were categorical in nature. To ensure consistency, we checked all the unique values within these categorical columns, such as <code>RACE_BIAS</code> and <code>RELIGION_BIAS</code>, and found no need for further standardization. Each category was consistently labeled, so no changes were necessary in terms of cleaning or formatting these values.</p>
<p>We also searched for missing values and duplicate rows. The dataset had very few missing values, and no duplicate entries were found. The only column that contained missing values was the <code>LOCATION_TYPE</code>, where some entries lacked information about where the hate crime occurred. To simplify the analysis, these missing values were replaced with the label “Unknown” instead of <code>NA</code>.</p>
<p>In addition, the date column <code>OCCURRENCE_DATE</code> and <code>REPORTED_DATE</code>—were originally in character format, so they were converted to proper date formats for convenience during analysis. Time columns, such as <code>OCCURRENCE_TIME</code> and <code>REPORTED_TIME</code>, were also reformatted into a standardized HH format.</p>
<p>Finally, we verified the <code>ARREST_MADE</code> column to ensure it contained only valid values, namely “YES” and “NO”. Any invalid or ambiguous entries were replaced with <code>NA</code>.</p>
<p>These steps ensured that the dataset was clean and ready for further analysis, free of inconsistencies or issues that might have impacted the results.</p>
</section>
<section id="basic-summary-statistics-of-the-data" class="level2">
<h2 class="anchored" data-anchor-id="basic-summary-statistics-of-the-data">2.3 Basic Summary Statistics of the Data</h2>
<p>The summary table @tbl-summary provides an overview of key variables from the hate crimes dataset, which spans from 2018 to 2023. The majority of incidents were reported in 2023. The most frequent occurrence locations were Streets/Roadways/Highways (287 incidents), with Division D32 handling the highest number of cases (177). A significant proportion of the crimes involved Race Bias, where Black individuals were the most frequently targeted (296 incidents), and Ethnicity Bias, with Chinese individuals being the most affected (40 incidents). Additionally, Religion Bias was notably prevalent against Jewish individuals, accounting for 485 out of 627 cases, while the most common Sexual Orientation Bias targeted 2SLGBTQ+ individuals (101 incidents).</p>
<p>In terms of primary offences, Mischief Under $5000 was the most common offence, appearing in 605 incidents, while arrests were made in 270 cases, representing 20% of the total. Mischief Under $5000 is a criminal offence involving willful damage or destruction of property valued at less than $5000, such as vandalizing a car with spray paint.The dataset also tracks bias categories related to Age, Mental or Physical Disability, and Gender, with the majority of cases lacking a specific bias in these categories. This breakdown provides insight into the nature and distribution of hate crimes in Toronto over the five-year period.</p>
<div id="tbl-summary" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Table: Summary of key variables
</figcaption>
<div aria-describedby="tbl-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 66%">
</colgroup>
<thead>
<tr class="header">
<th>Column Name</th>
<th>Statistic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>REPORTED_YEAR</td>
<td>Most Frequent: 2023, Range: 2018–2023</td>
</tr>
<tr class="even">
<td>LOCATION_TYPE</td>
<td>Most Frequent: Streets/Roadways/Highway, Count: 287</td>
</tr>
<tr class="odd">
<td>DIVISION</td>
<td>Most Frequent: D32, Count: 177</td>
</tr>
<tr class="even">
<td>OCCURRENCE_YEAR</td>
<td>Most Frequent: 2023, Range: 2018–2023</td>
</tr>
<tr class="odd">
<td>AGE_BIAS</td>
<td>Total Count: 0</td>
</tr>
<tr class="even">
<td>MENTAL_OR_PHYSICAL_DISABILITY</td>
<td>Total Count: 3</td>
</tr>
<tr class="odd">
<td>RACE_BIAS</td>
<td>Total Count: 428, Most Frequent: “Black”, Count: 296</td>
</tr>
<tr class="even">
<td>ETHNICITY_BIAS</td>
<td>Total Count: 168, Most Frequent: “Chinese”, Count: 40</td>
</tr>
<tr class="odd">
<td>LANGUAGE_BIAS</td>
<td>Total Count: 3, Most Frequent: “Hindi”, “Spanish”, “Tamil”, Count: 1</td>
</tr>
<tr class="even">
<td>RELIGION_BIAS</td>
<td>Total Count: 627, Most Frequent: “Jewish”, Count: 485</td>
</tr>
<tr class="odd">
<td>SEXUAL_ORIENTATION_BIAS</td>
<td>Total Count: 197, Most Frequent: “2SLGBTQ+”, Count: 101</td>
</tr>
<tr class="even">
<td>PRIMARY_OFFENCE</td>
<td>Total Count: 605, Most Frequent: “Mischief Under $5000”, Count: 605</td>
</tr>
<tr class="odd">
<td>GENDER_BIAS</td>
<td>Total Count: 78, Most Frequent: “Woman”, Count: 29</td>
</tr>
<tr class="even">
<td>ARREST_MADE</td>
<td>Total Arrest Made: 270</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<section id="discussion-of-data-selection" class="level3">
<h3 class="anchored" data-anchor-id="discussion-of-data-selection">2.4 Discussion of Data Selection</h3>
<p>Often, media reports on hate crimes in Toronto tend to focus on general trends, such as an increase in anti-Semitic hate crimes by a certain percentage, without offering much depth. While they might mention which group—whether LGBTQ, Muslim, or Black—was most affected by hate crimes, they rarely provide details on the types of incidents involved. For instance, they seldom specify whether these crimes were threats, verbal assaults, vandalism, or physical violence. Similarly, there is often little analysis of the geographic distribution of these crimes, leaving unanswered questions about which neighborhoods are more prone to specific hate crimes.</p>
<p>This dataset was chosen specifically to address these gaps in understanding. It allows for more granular analysis, helping to answer important questions such as: What types of hate crimes are committed against different groups like Muslims, Indian, Black, or Jewish people? Are these crimes more likely to involve threats, physical assaults, or vandalism?</p>
<p>By delving into these more specific and actionable details, this dataset can help communities, law enforcement, and policymakers better understand the nature of hate crimes and more effectively address them. This kind of detailed analysis offers a clearer path to targeted interventions, which could ultimately reduce the prevalence of hate crimes and support victims more effectively</p>
</section>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">3 Analysis</h2>
<section id="analysing-hate-crime-by-victim-group-and-bias-type" class="level3">
<h3 class="anchored" data-anchor-id="analysing-hate-crime-by-victim-group-and-bias-type">3.1 Analysing Hate Crime by Victim Group and Bias Type</h3>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalpaper_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>From the summary statistics, we observed that the most frequent hate crimes in Toronto are motivated by bias related to race, ethnicity, religion, or sexual orientation. \ref{figone} breaks down these categories and reveals the specific groups that are most affected. In terms of race, Black communities are disproportionately targeted, with the highest count of hate crimes. This aligns with numerous studies and reports that highlight systemic racism and the disproportionate criminalization of Black individuals in Canada and elsewhere . Religious bias, particularly antisemitism, remains the most significant in the dataset, with Jewish communities experiencing the highest hate crime rates by far. This trend has been documented consistently in media reports, showing that antisemitic hate crimes have increased in recent years .</p>
<p>Sexual orientation biases predominantly target 2SLGBTQ+ communities, especially gay and lesbian individuals, echoing findings from studies on homophobia and transphobia in urban areas . Interestingly, ethnic bias reflects a significant proportion of crimes against Chinese and Indian communities, which may correlate with a rise in xenophobic incidents, particularly during the COVID-19 pandemic when East Asian communities became frequent targets of hate.</p>
</section>
</section>
<section id="investigating-the-most-frequent-primary-offences-towards-victim-groups" class="level2">
<h2 class="anchored" data-anchor-id="investigating-the-most-frequent-primary-offences-towards-victim-groups">3.2 Investigating the most frequent Primary offences towards victim groups</h2>
<p>Understanding the types of hate crimes inflicted on different victim groups provides essential insights into the nature of targeted violence and bias in a community. By focusing on the offences committed against specific religious, racial, ethnic, or sexual orientation groups, we can analyse which groups face higher levels of violence and which experience different types of hate crimes. In this section, we analyze three figures representing crimes against Jewish, Muslim, Black, and 2SLGBTQ+ communities, as well as Indian and Chinese ethnicities. It must be noted that, in all of the following analysis, “assaults” refer to all primary offences that involve physical violence against an individual, including aggravated assault, simple assault, assault causing bodily harm etc. These types of crimes are typically categorized as violent crimes, as they involve direct harm or threats of harm to the victim, distinguishing them from non-violent offences such as property damage or verbal harassment.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalpaper_files/figure-html/figtwo-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="figtwo">(<a href="#ref-figtwo" role="doc-biblioref"><strong>figtwo?</strong></a>)</span> highlights the offences against Jewish and Muslim communities. Hate crimes against Jewish individuals are overwhelmingly categorized as “Mischief Under $5000,” a non-violent crime involving property damage. This pattern raises the question of why so many hate crimes against Jewish people take this form and whether it reflects broader societal biases or an inclination toward symbolic, property-based hate. On the other hand, hate crimes against Muslims, while fewer in number, are more likely to involve direct violence, with “Assault” being the most common offence. This contrast between the groups may suggest that hate crimes against Muslims are reported more often when they are violent, which could point to an underreporting of less severe crimes. It also highlights the harsher, more physical nature of Islamophobic hate crimes in contrast to anti-Semitic hate crimes, which tend to manifest more in property damage rather than physical harm.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalpaper_files/figure-html/figthree-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="figthree">(<a href="#ref-figthree" role="doc-biblioref"><strong>figthree?</strong></a>)</span> highlights that hate crimes targeting the Black and 2SLGBTQ+ communities still show “Mischief Under $5000” as the most common offence, similar to Jewish victims. However, both communities also experience a concerning level of violent crimes, such as assault and bodily harm. This updated data emphasizes that while property-related offences are frequent, physical violence against these groups remains alarmingly prevalent. In particular, the frequency of assaults against the 2SLGBTQ+ community signals heightened safety concerns, reflecting broader societal issues of targeted violence toward visibly marginalized groups.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalpaper_files/figure-html/figfour-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="figfour">(<a href="#ref-figfour" role="doc-biblioref"><strong>figfour?</strong></a>)</span> shows hate crimes against the Indian and Chinese communities. The most frequent hate crime towards both groups is assault, indicating that violent incidents disproportionately affect these communities. In fact, the number of violent hate crimes against Indians and Chinese is higher than that of Jewish individuals, the most victimized group overall. Moreover, the Chinese community also suffers from significant property-based crimes like “Mischief Under $5000” and harassment, suggesting that anti-Asian sentiment, especially following the COVID-19 pandemic, has exacerbated both violent and non-violent hate incidents. This trend mirrors the challenges faced by Black communities, highlighting the prevalence of both verbal and physical confrontations across various ethnic and racial groups.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalpaper_files/figure-html/figfive-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="figfive">(<a href="#ref-figfive" role="doc-biblioref"><strong>figfive?</strong></a>)</span> illustrates that the LGBTQ+ community experiences the highest number of assault-related hate crimes compared to other groups, such as Muslims, Indians, Chinese, and Jewish individuals. Here, assaults encompass all types of physical violence, including aggravated assault, assault causing bodily harm, and common assault. The much lower assault counts for other groups could indicate different patterns of hate crimes, where other forms like harassment or vandalism are more common.</p>
</section>
<section id="analysis-of-yearly-trend-of-hate-crimes" class="level2">
<h2 class="anchored" data-anchor-id="analysis-of-yearly-trend-of-hate-crimes">3.3 Analysis of Yearly Trend of Hate Crimes</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalpaper_files/figure-html/figsix-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="figsix">(<a href="#ref-figsix" role="doc-biblioref"><strong>figsix?</strong></a>)</span> the trend of reported hate crimes in Toronto over the past five years, segmented by quarter. The number of hate crimes fluctuates, with noticeable spikes, particularly in 2020 and 2023. There is a significant peak in mid-2020, which coincides with the global rise of racial and ethnic tensions during the pandemic. Another sharp increase is seen in 2023, reflecting a recent surge in hate crimes. This increase can be attributed to the tension created by the Israel-Hamas conflict in the last two quarters of 2023.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalpaper_files/figure-html/figseven-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="figseven">(<a href="#ref-figseven" role="doc-biblioref"><strong>figseven?</strong></a>)</span> shows the trends in hate crimes against various bias categories over time. Jewish communities are consistently the most targeted, with a sharp spike in hate crimes towards the end of the timeline. LGBTQ individuals also experience a worrying increase, particularly towards the end of 2022, with a high number of hate crimes sustained throughout the period. Muslim and Black communities show more variability but still exhibit periodic increases. Meanwhile, hate crimes against Chinese and Indian groups remain relatively low but constant, with occasional small surges. The general upward trend for most bias categories highlights a concerning increase in hate crimes, particularly in the last quarter of the analyzed period.</p>
</section>
<section id="geospatial-analysis-of-hate-crime-occurrences-in-toronto" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-analysis-of-hate-crime-occurrences-in-toronto">3.4 Geospatial Analysis of Hate Crime Occurrences in Toronto</h2>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Neighbourhoods - 4326' from data source 
  `/Users/shamayladurrin/Desktop/STA304/Term_Paper_1/data/raw_data/DataShape' 
  using driver `ESRI Shapefile'
Simple feature collection with 158 features and 11 fields
Geometry type: POLYGON
Dimension:     XY
Bounding box:  xmin: -79.63926 ymin: 43.581 xmax: -79.11527 ymax: 43.85546
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "parkwoodsoconnor hills"          "lambton baby point"             
[3] "beechboroughgreenbrook"          "brookhavenamesbury"             
[5] "alderwood"                       "willowridgemartingroverichview" 
[7] "rexdalekipling"                  "thistletownbeaumond heights"    
[9] "mount olivesilverstonejamestown"</code></pre>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalpaper_files/figure-html/TheMap-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="TheMap">(<a href="#ref-TheMap" role="doc-biblioref"><strong>TheMap?</strong></a>)</span> displays the distribution of hate crimes across different neighborhoods in Toronto. It clearly shows that certain areas, such as Old Toronto and parts of North York, experience a higher concentration of hate crimes compared to others. The color gradient, ranging from blue to red, indicates the frequency of reported hate crimes, with red signifying neighborhoods that have seen up to 50 hate crimes in the reporting period. Areas like Etobicoke and Scarborough appear to have fewer reported incidents. This visual insight helps understand geographical disparities in hate crime occurrences, which could be useful for targeting community outreach, resource allocation, and law enforcement strategies. These hotspots suggest that urban centers with higher population density might be more prone to hate crimes, an observation supported by studies linking hate crimes to urbanization .</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalpaper_files/figure-html/TheMap2-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="TheMap2">(<a href="#ref-TheMap2" role="doc-biblioref"><strong>TheMap2?</strong></a>)</span> represents the spatial distribution of hate crimes driven by sexual orientation bias across Toronto neighborhoods. It shows a higher incidence of such crimes in central areas like Old Toronto, with some activity extending to neighborhoods in North York, indicating these regions as focal points for hate crimes targeting the LGBTQ+ community.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="finalpaper_files/figure-html/TheMap3-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p><span class="citation" data-cites="TheMap3">(<a href="#ref-TheMap3" role="doc-biblioref"><strong>TheMap3?</strong></a>)</span> shows that areas like Old Toronto, North York, and parts of Etobicoke have higher occurrences of violent crimes towards Muslims, with some neighborhoods showing up to six incidents. This spatial distribution suggests potential hotspots for religious bias-motivated hate crimes within the city.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>